<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\users\funfine\source\quiz\quiz\complexityweb\services\taskservice\taskservicecontroller.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Threading.Tasks;
using Application.DTO;
using Application.TaskService;
using AutoMapper;
using Domain.Entities;
using Hjson;
using Infrastructure.Result;
using Microsoft.AspNetCore.Mvc;
using QuizWebApp.Services.TaskService.DTO;

namespace QuizWebApp.Services.TaskService
{
    [Route(&quot;service&quot;)]
    [ApiController]
    public partial class TaskServiceController : ControllerBase
    {
        private readonly ITaskService applicationApi;

        public TaskServiceController(ITaskService applicationApi)
        {
            this.applicationApi = applicationApi;
        }

        /// &lt;summary&gt;
        ///     Получить генераторы из уровня
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     GET service/0/1/templateGenerators
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Возвращает генераторы&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы или уровня не найдены&lt;/response&gt;
        [HttpGet(&quot;{topicId}/{levelId}/templateGenerators&quot;)]
        public ActionResult&lt;IEnumerable&lt;AdminTemplateGeneratorDTO&gt;&gt; GetTemplateGenerators(Guid topicId, Guid levelId)
        {
            var (_, isFailure, generators, error) = applicationApi.GetTemplateGenerators(topicId, levelId);
            if (isFailure)
                return NotFound(error.Message);
            return Ok(generators.Select(Mapper.Map&lt;AdminTemplateGeneratorDTO&gt;));
        }

        /// &lt;summary&gt;
        ///     Добавляет в сервис новый пустую тему
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     POST service/addTopic
        ///     {
        ///         &quot;name&quot;: &quot;Сложность алгоритмов&quot;,
        ///         &quot;description&quot;: &quot;Оценка сложностей алгоритмов&quot;
        ///     }
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Возвращает Id от новой темы&lt;/response&gt;
        [HttpPost(&quot;topic&quot;)]
        public ActionResult&lt;Guid&gt; AddEmptyTopic([FromBody] EmptyTopicDTO topic)
        {
            var topicGuid = applicationApi.AddEmptyTopic(topic.Name, topic.Description);
            return Ok(topicGuid);
        }

        /// &lt;summary&gt;
        ///     Удаляет тему из сервиса
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     DELETE service/deleteTopic/1
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Тема была успешно удалена&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы не найден&lt;/response&gt;
        [HttpDelete(&quot;topic/{topicId}&quot;)]
        public ActionResult DeleteTopic(Guid topicId)
        {
            var (_, isFailure, _, error) = applicationApi.DeleteTopic(topicId);
            if (isFailure)
                return NotFound(error.Message);
            return Ok();
        }

        /// &lt;summary&gt;
        ///     Добавляет в сервис пустой уровень
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     POST service/0/addLevel
        ///     {
        ///         &quot;description&quot;: &quot;Оценка сложности алгоритмов&quot;,
        ///         &quot;nextLevels&quot;: [0, 1],
        ///         &quot;previousLevels&quot;: [2, 3]
        ///     }
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Возвращает Id нового уровня&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы не найден&lt;/response&gt;
        [HttpPost(&quot;{topicId}/level&quot;)]
        public ActionResult&lt;Guid&gt; AddLevel(Guid topicId, [FromBody] EmptyLevelDTO level)
        {
            var (_, isFailure, id, error) = applicationApi
                .AddEmptyLevel(
                   topicId,
                   level.Description,
                   level.PreviousLevels,
                   level.NextLevels);
            if (isFailure)
                return NotFound(error.Message);
            return Ok(id);
        }

        /// &lt;summary&gt;
        ///     Удаляет уровень из сервиса.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     DELETE service/1/deleteLevel/1
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; уровень был успешно удален&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы или уровня не найдены&lt;/response&gt;
        [HttpDelete(&quot;{topicId}/level/{levelId}&quot;)]
        public ActionResult DeleteLevel(Guid topicId, Guid levelId)
        {
            var (_, isFailure, _, error) = applicationApi.DeleteLevel(topicId, levelId);
            if (isFailure)
                return NotFound(error.Message);
            return Ok();
        }

        /// &lt;summary&gt;
        ///     Добавляет в сервис новый генератор
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     POST service/addTemplateGenerator/1/0
        ///     {
        ///        &quot;question&quot;: &quot;Оцените временную сложность алгоритма&quot;,
        ///        &quot;text&quot;: &quot;for (int i = {{from1}}; i &amp;lt; {{to1}}; i += {{iter1}})\r\nc++\r\n&quot;,
        ///        &quot;possibleAnswers&quot;: [&quot;Θ(1)&quot;, &quot;Θ(log({{to1}}))&quot;, &quot;Θ({{to1}})&quot;],
        ///        &quot;answer&quot;: &quot;Θ({{to1}})&quot;,
        ///        &quot;hints&quot;: [],
        ///        &quot;streak&quot;: 1
        ///     }
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Возвращает Id нового генератора&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы или уровня не найдены&lt;/response&gt;
        [HttpPost(&quot;{topicId}/{levelId}/templateGenerator&quot;)]
        public ActionResult&lt;Guid&gt; AddTemplateGenerator(
            Guid topicId,
            Guid levelId,
            [FromBody] TemplateGeneratorDTO templateGenerator)
        {
            var (_, isFailure, id, error) = applicationApi
                .AddTemplateGenerator(
                  topicId,
                  levelId,
                  templateGenerator.Text,
                  templateGenerator.PossibleAnswers,
                  templateGenerator.Answer, templateGenerator.Hints, templateGenerator.Streak,
                  templateGenerator.Question);
            if (isFailure)
                return NotFound(error.Message);
            return Ok(id);
        }

        /// &lt;summary&gt;
        ///     Удаляет генератор из сервиса.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     Sample request:
        ///     &lt;code&gt;
        ///     DELETE service/1/0/deleteGenerator/2
        ///     &lt;/code&gt;
        /// &lt;/remarks&gt;
        /// &lt;response code=&quot;200&quot;&gt; Генератор был успешно удален&lt;/response&gt;
        /// &lt;response code=&quot;404&quot;&gt; Id темы, уровня или генератора не найдены&lt;/response&gt;
        [HttpDelete(&quot;{topicId}/{levelId}/generator/{generatorId}&quot;)]
        public ActionResult DeleteGenerator(Guid topicId, Guid levelId, Guid generatorId)
        {
            var (_, isFailure, _, error) = applicationApi.DeleteGenerator(topicId, levelId, generatorId);
            if (isFailure)
                return NotFound(error.Message);
            return Ok();
        }

    }

   
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[23,9,23,66,0],[24,9,24,10,0],[25,13,25,50,0],[26,9,26,10,0],[41,9,41,10,0],[42,13,42,108,0],[43,13,43,27,0],[44,17,44,48,0],[45,13,45,81,0],[46,9,46,10,0],[64,9,64,10,0],[65,13,65,89,0],[66,13,66,34,0],[67,9,67,10,0],[82,9,82,10,0],[83,13,83,80,0],[84,13,84,27,0],[85,17,85,48,0],[86,13,86,25,0],[87,9,87,10,0],[107,9,107,10,0],[108,13,113,38,0],[114,13,114,27,0],[115,17,115,48,0],[116,13,116,27,0],[117,9,117,10,0],[132,9,132,10,0],[133,13,133,89,0],[134,13,134,27,0],[135,17,135,48,0],[136,13,136,25,0],[137,9,137,10,0],[163,9,163,10,0],[164,13,171,47,0],[172,13,172,27,0],[173,17,173,48,0],[174,13,174,27,0],[175,9,175,10,0],[190,9,190,10,0],[191,13,191,106,0],[192,13,192,27,0],[193,17,193,48,0],[194,13,194,25,0],[195,9,195,10,0]]);
    </script>
  </body>
</html>