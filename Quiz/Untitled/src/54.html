<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\users\funfine\source\quiz\quiz\infrastructure\result\maybe.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;

namespace Infrastructure.Result
{
    public struct Maybe&lt;T&gt; : IEquatable&lt;Maybe&lt;T&gt;&gt;
    {
        private readonly MaybeValueWrapper value;
        public T Value =&gt; HasNoValue ? throw new InvalidOperationException() : value.Value;

        public static Maybe&lt;T&gt; None =&gt; new Maybe&lt;T&gt;();

        public bool HasValue =&gt; value != null;
        public bool HasNoValue =&gt; !HasValue;

        private Maybe(T value)
        {
            this.value = value == null ? null : new MaybeValueWrapper(value);
        }

        public static implicit operator Maybe&lt;T&gt;(T value)
        {
            if (value?.GetType() == typeof(Maybe&lt;T&gt;)) return (Maybe&lt;T&gt;) (object) value;

            return new Maybe&lt;T&gt;(value);
        }

        public static Maybe&lt;T&gt; From(T obj) =&gt; new Maybe&lt;T&gt;(obj);

        public static bool operator ==(Maybe&lt;T&gt; maybe, T value)
        {
            if (value is Maybe&lt;T&gt;)
                return maybe.Equals(value);

            return !maybe.HasNoValue &amp;&amp; maybe.Value.Equals(value);
        }

        public static bool operator !=(Maybe&lt;T&gt; maybe, T value) =&gt; !(maybe == value);

        public static bool operator ==(Maybe&lt;T&gt; first, Maybe&lt;T&gt; second) =&gt; first.Equals(second);

        public static bool operator !=(Maybe&lt;T&gt; first, Maybe&lt;T&gt; second) =&gt; !(first == second);

        public override bool Equals(object obj)
        {
            if (obj == null)
                return false;

            if (obj.GetType() != typeof(Maybe&lt;T&gt;))
            {
                if (obj is T obj1) obj = new Maybe&lt;T&gt;(obj1);

                if (!(obj is Maybe&lt;T&gt;))
                    return false;
            }

            var other = (Maybe&lt;T&gt;) obj;
            return Equals(other);
        }

        public bool Equals(Maybe&lt;T&gt; other)
        {
            if (HasNoValue &amp;&amp; other.HasNoValue)
                return true;

            if (HasNoValue || other.HasNoValue)
                return false;

            return value.Value.Equals(other.value.Value);
        }

        public override int GetHashCode() =&gt; HasNoValue ? 0 : value.Value.GetHashCode();

        public override string ToString() =&gt; HasNoValue ? &quot;No value&quot; : Value.ToString();

        private class MaybeValueWrapper
        {
            internal readonly T Value;

            public MaybeValueWrapper(T value)
            {
                Value = value;
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[8,27,8,91,0],[10,40,10,54,0],[12,33,12,46,0],[13,35,13,44,0],[16,9,16,10,0],[17,13,17,78,0],[18,9,18,10,0],[21,9,21,10,0],[22,13,22,54,0],[22,55,22,88,0],[24,13,24,40,0],[25,9,25,10,0],[27,47,27,64,0],[30,9,30,10,0],[31,13,31,35,0],[32,17,32,44,0],[34,13,34,67,0],[35,9,35,10,0],[37,68,37,85,0],[39,76,39,96,0],[41,76,41,94,0],[44,9,44,10,0],[45,13,45,29,0],[46,17,46,30,0],[48,13,48,51,0],[49,13,49,14,0],[50,17,50,35,0],[50,36,50,61,0],[52,17,52,40,0],[53,21,53,34,0],[54,13,54,14,0],[56,13,56,40,0],[57,13,57,34,0],[58,9,58,10,0],[61,9,61,10,0],[62,13,62,48,0],[63,17,63,29,0],[65,13,65,48,0],[66,17,66,30,0],[68,13,68,58,0],[69,9,69,10,0],[71,46,71,88,0],[73,46,73,88,0],[79,13,79,46,0],[80,13,80,14,0],[81,17,81,31,0],[82,13,82,14,0]]);
    </script>
  </body>
</html>