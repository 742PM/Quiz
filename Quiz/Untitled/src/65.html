<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>e:\users\funfine\source\quiz\quiz\infrastructure\extensions\enumerableextensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;

namespace Infrastructure.Extensions
{
    public static class EnumerableExtensions
    {
        public static IEnumerable&lt;TResult&gt; Zip&lt;T1, T2, T3, TResult&gt;(
            this IEnumerable&lt;T1&gt; source,
            IEnumerable&lt;T2&gt; second,
            IEnumerable&lt;T3&gt; third,
            Func&lt;T1, T2, T3, TResult&gt; func)
        {
            using (var e1 = source.GetEnumerator())
            {
                using (var e2 = second.GetEnumerator())
                {
                    using (var e3 = third.GetEnumerator())
                    {
                        while (e1.MoveNext() &amp;&amp; e2.MoveNext() &amp;&amp; e3.MoveNext())
                            yield return func(e1.Current, e2.Current, e3.Current);
                    }
                }
            }
        }

        private static IEnumerable&lt;T&gt; Shuffle&lt;T&gt;(this IEnumerable&lt;T&gt; enumerable, Random random)
        {
            random = random ?? new Random(42);
            return enumerable.OrderBy(_ =&gt; random.Next());
        }

        public static IEnumerable&lt;T&gt; TakeRandom&lt;T&gt;(
            this IEnumerable&lt;T&gt; enumerable,
            Random random,
            int amount = 1) =&gt; enumerable.Shuffle(random).Take(amount);

        public static T TakeRandomOne&lt;T&gt;(
            this IEnumerable&lt;T&gt; enumerable,
            Random random = default) =&gt; enumerable.TakeRandom(random).First();

        public static Dictionary&lt;TKey, TValue&gt; SafeToDictionary&lt;TSource, TKey, TValue&gt;(
            this IEnumerable&lt;TSource&gt; enumerable,
            Func&lt;TSource, TKey&gt; keySelector,
            Func&lt;TSource, TValue&gt; valueSelector)
        {
            var comparer = new KeyComparer&lt;TSource, TKey&gt;(keySelector);
            return enumerable
                .Distinct(comparer)
                .ToDictionary(keySelector, valueSelector);
        }

        public static Dictionary&lt;TKey, TSource&gt; SafeToDictionary&lt;TSource, TKey&gt;(
            this IEnumerable&lt;TSource&gt; enumerable,
            Func&lt;TSource, TKey&gt; keySelector)
        {
            var comparer = new KeyComparer&lt;TSource, TKey&gt;(keySelector);
            return enumerable
                .Distinct(comparer)
                .ToDictionary(keySelector);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[14,9,14,10,1],[15,20,15,51,1],[16,13,16,14,1],[17,24,17,55,1],[18,17,18,18,1],[19,28,19,58,1],[20,21,20,22,1],[21,25,21,80,1],[22,29,22,83,1],[23,21,23,22,1],[24,17,24,18,1],[25,13,25,14,1],[26,9,26,10,1],[29,9,29,10,1],[30,13,30,47,1],[31,13,31,44,1],[31,44,31,57,1],[31,57,31,59,1],[31,13,31,59,1],[32,9,32,10,1],[37,32,37,71,1],[41,41,41,78,1],[47,9,47,10,1],[48,13,48,72,1],[49,13,51,59,1],[52,9,52,10,1],[57,9,57,10,0],[58,13,58,72,0],[59,13,61,44,0],[62,9,62,10,0]]);
    </script>
  </body>
</html>